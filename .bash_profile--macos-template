######################################################################
# Prepend the GNU binaries to the path
_paths=(
  '/opt/homebrew/opt/gnu-tar/libexec/gnubin'
  '/opt/homebrew/opt/make/libexec/gnubin'
  '/opt/homebrew/opt/gnu-sed/libexec/gnubin'
  '/opt/homebrew/opt/gawk/libexec/gnubin'
  '/opt/homebrew/opt/grep/libexec/gnubin'
  '/opt/homebrew/opt/gnu-getopt/bin'
  '/opt/homebrew/opt/unzip/bin'
  '/opt/homebrew/opt/m4/bin'
  '/opt/homebrew/opt/icu4c/bin'
  '/opt/homebrew/opt/icu4c/sbin'
  '/opt/homebrew/opt/mysql-client/bin'
  "$HOME/.local/bin"
  "$HOME/dotfiles/scripts"
)

_joined_paths=''

for __path in "${_paths[@]}"; do
  _joined_paths="$__path:$_joined_paths"
done

# Remove our custom paths if already exists.
PATH="${PATH//$_joined_paths/''}"
PATH="$_joined_paths$PATH"

pkgs_=(
  zlib
  icu4c
  mysql-client
)
ldflags_=
cppflags_=
pkg_config_paths_=

for pkg_ in "${pkgs_[@]}"; do
  ldflag_="-L/opt/homebrew/opt/$pkg_/lib"

  if ! grep -qE -- "${ldflag_}" <<<"${LDFLAGS}"; then
    ldflags_+=" $ldflag_"
    cppflags_+=" -I/opt/homebrew/opt/$pkg_/include"
    pkg_config_paths_+="/opt/homebrew/opt/$pkg_/lib/pkgconfig:"
  fi
done

export LDFLAGS="$LDFLAGS $ldflags_"
export CPPFLAGS="$CPPFLAGS $cppflags_"
export PKG_CONFIG_PATH="${pkg_config_paths_}${PKG_CONFIG_PATH}"

unset _paths
unset __path
unset _joined_paths
unset pkgs_
unset pkg_
unset ldflags_
unset cppflags_
unset pkg_config_paths_
######################################################################

eval "$(/opt/homebrew/bin/brew shellenv)"

if [[ -r "/opt/homebrew/etc/profile.d/bash_completion.sh" ]]; then
  . "/opt/homebrew/etc/profile.d/bash_completion.sh"
fi

if [ -s "$HOME/.bashrc" ]; then
  . "$HOME/.bashrc"
fi

test -e "${HOME}/.iterm2_shell_integration.bash" && source "${HOME}/.iterm2_shell_integration.bash"

# Added by LM Studio CLI (lms)
export PATH="$PATH:/Users/kanmii/.lmstudio/bin"
# End of LM Studio CLI section
